<hlm-popover>
    <button hlmBtn variant="ghost" size="sm" hlmPopoverTrigger (click)="openCamera()">
        <ng-icon hlm size="base" name="lucideCamera" />
    </button>

    <hlm-popover-content *hlmPopoverPortal="let ctx"
        class="!fixed !inset-0 !z-[9999] !w-screen !h-screen !max-w-none !max-h-none !rounded-none !border-0 bg-black p-0">
        <button hlmBtn variant="ghost" size="sm"
            class="absolute right-4 top-4 z-20 rounded-full bg-black/60 text-white backdrop-blur hover:bg-black/80"
            (click)="closePopover(ctx)" aria-label="Fermer">
            <ng-icon hlm size="base" name="lucideX" />
        </button>

        <div class="absolute left-0 right-0 top-0 z-10 flex items-center justify-between px-4 py-3">
            <div class="text-sm font-medium text-white">Cam√©ra</div>
            <button hlmBtn variant="ghost" size="sm" class="text-white hover:bg-white/10" (click)="stop()">
                Stop
            </button>
        </div>

        <div class="absolute inset-0">
            <video #video autoplay playsinline muted class="absolute inset-0 h-full w-full object-cover"></video>

            @if (shot()) {
            <img [src]="shot()!" alt="preview" class="absolute inset-0 h-full w-full object-cover" />
            }

            <div class="absolute left-4 top-16 z-10">
                <div
                    class="inline-flex items-center gap-2 rounded-full bg-black/60 px-3 py-1 text-xs text-white backdrop-blur">
                    <span class="h-2 w-2 rounded-full bg-red-500"></span>
                    LIVE
                </div>
            </div>
        </div>

        <div class="absolute bottom-0 left-0 right-0 z-10 pb-7 pt-8">
            <div class="flex items-center justify-center gap-4 px-4">
                @if (!shot()) {
                <button
                    class="h-16 w-16 rounded-full border-4 border-white bg-white/10 backdrop-blur transition active:scale-95"
                    (click)="capturePreview()" aria-label="Capturer"></button>
                } @else {
                <button hlmBtn size="lg" variant="outline" class="rounded-full px-8" (click)="clearShot()">
                    Try Again
                </button>

                <button hlmBtn size="lg" variant="secondary" class="rounded-full px-8" (click)="uploadCapture(ctx)">
                    Upload
                </button>
                }
            </div>
        </div>
    </hlm-popover-content>
</hlm-popover>